# Excelize v2.4.1

* Версия выпущена: Август 2, 2021
* Выпуск GitHub: [https://github.com/xuri/excelize/releases/tag/v2.4.1](https://github.com/xuri/excelize/releases/tag/v2.4.1)

## Примечания к выпуску

Наиболее заметные изменения в этом выпуске:

### Совместимость

Измените путь импорта модулей Go на `github.com/xuri/excelize/v2`

### Примечательные особенности

* Поддержка установки ширины столбца в потоковом режиме, связанная проблема [#625](https://github.com/xuri/excelize/issues/625)
* Поддержка слияния ячеек в потоковом режиме, связанная проблема [#826](https://github.com/xuri/excelize/issues/826)
* Новая поддержка 2 функций формулы: BESSELK, BESSELY
* Механизм вычисления формул теперь поддерживает определенные ссылки на имена
* Добавить опцию отключения для графиков xAxis и yAxis
* Функция [`AddPivotTable`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.AddPivotTable) поддерживает диапазон ссылочных исходных данных по определенному имени, связанная проблема [#856](https://github.com/xuri/excelize/issues/856)
* Следующая функция теперь - безопасность параллелизма, связанная проблема #861
  * [`AddPicture`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.AddPicture) и [`GetPicture`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.GetPicture) параллелизм вставляют или получают изображение с листа
  * [`Rows`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.Rows) и [`Cols`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.Cols) параллелизм итерации строк и столбцов
  * Ячейки набора параллелизма [`SetSheetRow`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.SetSheetRow) для строки на листе
  * Стиль ячейки набора параллелизма [`SetCellStyle`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.SetCellStyle)
  * Параллелизм [`NewStyle`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.NewStyle) создает стиль
* Сообщение об ошибке функции экспорта 24

### Улучшение совместимости

* Улучшена совместимость атрибутов пространства имен XML по умолчанию, исправлено сгенерированное поврежденное файл в некоторых случаях
* Улучшена совместимость с нестандартными атрибутами настройки страницы, исправлена ошибка открытия электронной таблицы в некоторых случаях
* Добавление атрибута count в таблицу общих строк
* Удалите требование часового пояса UTC при установке значения ячейки со временем, решенная проблема [#409](https://github.com/xuri/excelize/issues/409)
* Улучшена совместимость с управляющим символом XML в строке escape-литерала
* Переименовать экспортируемый поле `File.XLSX` в `File.Pkg`
* Изменение имен листов без учета регистра для `NewSheet`, `GetSheetIndex`, `DeleteSheet`, решенная проблема [#873](https://github.com/xuri/excelize/issues/873)
* Исправить отсутствующий атрибут сводки условного форматирования, решенная проблема [#883](https://github.com/xuri/excelize/issues/883)
* Улучшение совместимости с недопустимым атрибутом номера первой страницы в макете страницы
* Добавить максимальное количество символов и исправить отсутствующий символ сохранения для [`SetCellRichText`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.SetCellRichText)

### Исправление ошибок

* Исправлена ошибка синтаксического анализа формата времени 12/24 часов, решенная проблема [#823](https://github.com/xuri/excelize/issues/823), [#841](https://github.com/xuri/excelize/issues/841)
* Исправлена ошибка, из-за которой в некоторых случаях нельзя было получить комментарии от [`GetComments`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.GetComments), решенная проблема [#825](https://github.com/xuri/excelize/issues/825)
* Исправлена проблема при получении и добавлении комментариев к нескольким авторам, решенная проблема [#829](https://github.com/xuri/excelize/issues/829), [#830](https://github.com/xuri/excelize/issues/830)
* Исправьте неверный путь к файлу и повторяющееся пространство имен при повторном создании рабочего листа, решенная проблема [#834](https://github.com/xuri/excelize/issues/834)
* Исправлена ошибка, из-за которой атрибуты схемы набора не работали, когда значения атрибутов `showOutlineSymbols`, `summaryBelow` и `summaryRight` равны `false`
* Избегайте пустых строк в конце рабочего листа с помощью [`GetRows`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.GetRows), решенная проблема [#842](https://github.com/xuri/excelize/issues/842)
* Исправление отсутствующей ячейки формулы при получении значений строк, решенная проблема [#855](https://github.com/xuri/excelize/issues/855)
* Исправить ошибку сравнения внутри и вне функции ЕСЛИ, решенная проблема [#858](https://github.com/xuri/excelize/issues/858)
* Фикс [`GetRowHeight`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.GetRowHeight) на самом деле получает высоту следующей строки
* Исправить неправильную область видимости при получении и удалении определенного имени, решенная проблема [#879](https://github.com/xuri/excelize/issues/879)
* Атрибут `LocalSheetID` в заданном имени должен быть равен `SheetIndex` вместо `SheetID`
* Исправлено отсутствие набора стилей каждой ячейки при установке стиля столбцов, решенная проблема [#467](https://github.com/xuri/excelize/issues/467)
* Предотвращение паники, когда неверный диапазон указан как `PivotTableRange` при создании сводной таблицы
* Исправлена проблема с точностью чтения десятичных знаков, решенная проблема [#848](https://github.com/xuri/excelize/issues/848) и [#852](https://github.com/xuri/excelize/issues/852)
* Избегайте символа XML в выпадающем списке, избегайте сгенерированного поврежденного файла, решенная проблема [#971](https://github.com/xuri/excelize/issues/971)
* Исправить неправильный лимит количества символов в выпадающем списке, решенная проблема [#972](https://github.com/xuri/excelize/issues/972)
* Исправлена высокая загрузка ЦП при чтении значения ячейки с числовым форматом, вызванная в некоторых случаях проблемой синтаксического анализа времени Excel, решенная проблема [#974](https://github.com/xuri/excelize/issues/974)
* Исправить ошибку разбора месяца в произвольном числовом формате в некоторых случаях

### Оптимизация производительности

* Уменьшите избыточную память на [`Save`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.Save) и [`SaveAs`](https://pkg.go.dev/github.com/xuri/excelize/v2@v2.4.1#File.SaveAs) не более чем на 19% по сравнению с ранее выпущенной версией

### Другие

* Исправить проблему безопасности кода CWE-190 и CWE-681
* Обновлен модуль зависимостей
* Унитарные тесты и godoc обновлены
* Используйте GitHub Action для модульного тестирования
* [Веб-сайт документации](https://xuri.me/excelize) с многоязычным: арабский, немецкий, испанский, английский, французский, русский, китайский, японский и корейский языки, который был обновлен

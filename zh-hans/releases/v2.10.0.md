# Excelize v2.10.0

{{ book.info }}

* 即将发布：2025年10月14日

## 版本说明

此版本中最显著的变化包括：

### 新增功能

* 新增导出的错误变量 `ErrTransparency`
* 新增 3 项数据类型：`ChartDashType`、`CustomProperty` 和 `ZipWriter`
* 在 `ChartMarker` 数据类型中新增 `Border` 字段
* 在 `ChartLegend` 数据类型中新增 `Font` 字段
* 在 `ChartSeries` 数据类型中新增 `Legend` 字段
* 在 `Fill` 数据类型中新增 `Transparency` 字段
* 在 `ChartLine` 数据类型中新增 `Dash` 和 `Fill` 字段
* 在 `Options` 数据类型中新增 `TmpDir` 字段，支持指定用于创建临时文件的临时目录，相关 issue [#2024](https://github.com/xuri/excelize/issues/2024)
* 在 `Font` 数据类型中新增 `Charset` 字段，支持指定字体编码
* 新增 2 项函数 `GetCustomProps` 和 `SetCustomProps`，支持获取和设置工作簿的自定义属性，相关 issue [#2146](https://github.com/xuri/excelize/issues/2146)
* 新增函数 `SetZipWriter`，支持设置自定义 ZIP 写入器，相关 issue [#2199](https://github.com/xuri/excelize/issues/2199)
* 在函数 `GetMergeCells` 中新增可选参数 `withoutValues`，支持获取合并单元格时忽略读区合并单元格的值
* 函数 `DeleteDataValidation` 支持删除扩展列表中的数据验证，并支持通过引用序列数组或空格分隔的引用字符串，对多个单元格范围进行删除，相关 issue [#2133](https://github.com/xuri/excelize/issues/2133)
* 函数 `AddChart` 支持设置图表的虚线样式和数据点边框类型
* 函数 `AddChart` 支持设置图表图例的字体，相关 issue [#2169](https://github.com/xuri/excelize/issues/2169)
* 函数 `AddChart` 和 `AddChartSheet` 支持创建 4 种箱体和蜡烛图类型股票图表：最高价-最低价-收盘价、开盘价-最高价-最低价-收盘价、成交量-最高价-最低价-收盘价、成交量-开盘价-最高价-最低价-收盘价图表
* 函数 `CalcCellValue` 支持计算 BAHTTEXT 公式函数
* 当字体字号小于最小值时，创建样式时将不再使用默认字体大小代替，而是忽略无效的字号设置
* 支持解析带有伊斯兰历的单元格数字格式
* 支持为图表和形状设置透明度，相关 issue [#2176](https://github.com/xuri/excelize/issues/2176)
* 新增对以下 9 种语言的数字格式支持：科西嘉语、克罗地亚语、克罗地亚语（拉丁）、捷克语、丹麦语、迪维希语、荷兰语、不丹语

### 兼容性提升

* 设置单元格公式时移除所有前导等号，以提升与 Apple Numbers 的兼容性，相关 issue [#2145](https://github.com/xuri/excelize/issues/2145)
* 在工作簿内部关系部件中为工作表使用相对路径

### 问题修复

* 修复 v2.9.1 中引入的问题，修复 ARMv7 架构上构建失败的问题，解决 issue [#2132](https://github.com/xuri/excelize/issues/2132)
* 修复在数字格式解析器解析结果中，数字格式末尾的空白字符丢失问题
* 修复部分情况下，读取单元格时由于内部索引偏移范围无效导致的 panic 问题，解决 issue [#2019](https://github.com/xuri/excelize/issues/2019) 和 [#2150](https://github.com/xuri/excelize/issues/2150)
* 修复部分情况下，读取带有不支持的数据透视表缓存源类型时出现的 panic 问题，解决 issue [#2161](https://github.com/xuri/excelize/issues/2161)
* 修复字符验证错误，在字符长度限制检查中将字符作为单个字符计数，解决 issue [#2167](https://github.com/xuri/excelize/issues/2167)
* 修复部分情况下，添加数据透视表后，生成的工作簿在 Mac 版本 Excel 打开时提示文档损坏的问题，解决 issue [#2180](https://github.com/xuri/excelize/issues/2180)
* 修复读取包含藏语数字格式代码的单元格时月份缩写错误的问题
* 修复读取 1900 年带有特殊日期数字格式的结果与 Excel 不一致的问题，解决 issue [#2192](https://github.com/xuri/excelize/issues/2192)

### 其他

* Go Modules 依赖模块更新
* 单元测试与文档更新
* 包含阿拉伯语、德语、英语、西班牙语、法语、意大利语、日语、韩语、葡萄牙语、俄语、简体中文和繁体中文的[多国语言文档网站](https://xuri.me/excelize)更新
* 支持 WebAssembly / JavaScript 的 [excelize-wasm](https://github.com/xuri/excelize-wasm) NPM 包发布版本更新
* 支持 Python 的 [excelize](https://github.com/xuri/excelize-py) PyPI 包发布版本更新

### 致谢

感谢 Excelize 的所有贡献者，以下是为此版本提交代码的贡献者列表：

* @DengY11 (Yi Deng)
* @JerryLuo-2005
* @aliavd1 (Ali Vatandoost)
* @xiaoq898
* @Now-Shimmer
* @Jameshu0513
* @mengpromax (MengZhongYuan)
* @Leopard31415926
* @hongjr03 (Hong Jiarong)
* @juefeng
* @black-butler
* @Neugls
* @Leo012345678
* @a2659802
* @torotake
* @crush-wu
* @zhuyanhuazhuyanhua

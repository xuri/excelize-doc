# Excelize v2.5.0

* 即⑨出: 2022年1月3日

## Release Notes

此版本中最@著的化包括：

### 兼容性提示

* 打_已有活簿或在@取列迭代器後，需要{用的 `Close` P]活簿和Y料流
* 修改 `ReadZipReader`  `File` 的F, 支持通^x指定解褐却婊蛭募系y
* 移除了不必要的С鲎 `XMLHeader`，可使用 `encoding/xml` 包的 `xml.Header` 代替
* 移除了不再使用的С鲎 `ErrToExcelTime`

### 新增功能

* 新增 API: `SetRowStyle` 支持O定整列邮, 相P issue [#990](https://github.com/xuri/excelize/issues/990)
* 新增 API: `GetCellType` 支持@取存Ω褓Y料型e, 相P issue [#417](https://github.com/xuri/excelize/issues/417) 和 [#520](https://github.com/xuri/excelize/issues/520)
* 新增 API: `SetAppProps` 和 `GetAppProps` 支持O定c@取活簿用程式傩, 相P issue [#1095](https://github.com/xuri/excelize/issues/1095)
* `GetCellValue`, `GetRows`, `GetCols`, `Rows` 和 `Cols` 支持指定是否x取存Ω裨始值而不用底指袷奖磉_式, 相P issue [#621](https://github.com/xuri/excelize/issues/621)
* 新增 95 公式函: ACCRINT, ACCRINTM, ADDRESS, AMORDEGRC, AMORLINC, AVEDEV, AVERAGEIF, CHIDIST, CONFIDENCE, CONFIDENCE.NORM, COUNTIF, COUNTIFS, COUPDAYBS, COUPDAYS, COUPDAYSNC, COUPNCD, COUPNUM, COUPPCD, DATEVALUE, DAY, DAYS, DELTA, DEVSQ, DISC, DURATION, ERF, ERF.PRECISE, ERFC, ERFC.PRECISE, GEOMEAN, GESTEP, IFNA, IFS, INDEX, INTRATE, ISFORMULA, ISLOGICAL, ISREF, ISOWEEKNUM, MATCH, MAXA, MAXIFS, MDURATION, MINIFS, MINUTE, MONTH, ODDFPRICE, PERCENTILE.EXC, PERCENTRANK.EXC, PERCENTRANK.INC, PERCENTRANK, PRICE, PRICEDISC, PRICEMAT, PV, QUARTILE.EXC, RANK, RANK.EQ, RATE, RECEIVED, RRI, SHEETS, SLN, STANDARDIZE, STDEV.P, STDEVP, SWITCH, SYD, TBILLEQ, TBILLPRICE, TBILLYIELD, TEXTJOIN, TIME, TRANSPOSE, TRIMMEAN, VALUE, VAR, VAR.S, VARA, VARPA, VDB, WEEKDAY, WEIBULL, WEIBULL.DIST, XIRR, XLOOKUP, XNPV, XOR, YEAR, YEARFRAC, YIELD, YIELDDISC, YIELDMAT, Z.TEST, ZTEST, 相P issue [#65](https://github.com/xuri/excelize/issues/65) 和 [#1002](https://github.com/xuri/excelize/issues/1002)
* 公式算引擎支持嵌套 `IF` 函, 相P issue [#987](https://github.com/xuri/excelize/issues/)
* 公式算引擎支持共享公式, 相P issue [#844](https://github.com/xuri/excelize/issues/)
* 公式算引擎支持文本比^\算, 相P issue [#998](https://github.com/xuri/excelize/issues/)
* 支持在Y料C中使用公式, 相P issue [#1012](https://github.com/xuri/excelize/issues/)
* 支持文n嚎s比限制，避免在的嚎s包炸攻
* `SetCellFormula` 支持O定共享公式
* `UpdateLinkedValue` 在清除存Ω裼算存r⑻^ macro sheet, 相P issue [#1014](https://github.com/xuri/excelize/issues/1014)
* 修筒糠智r下，由於炔恳蕾PS算e`е碌 `AddPicture` 重建D片的}, 相P issue [#1017](https://github.com/xuri/excelize/issues/1017)
* `AddShape` 支持O定形钶廓l度, 相P issue [#262](https://github.com/xuri/excelize/issues/262)
* 新增文n打_x `UnzipXMLSizeLimit` 以支持指定打_每工作表以及共享字符表r的却娼荷舷
* 建邮r，若o定的自定x底指袷o效，⒎祷劐e`提示，相P issue [#1028](https://github.com/xuri/excelize/issues/1028)
* 流式入F已支持O定列邮
* 流式入器rg型e存Ω建rg底指袷邮剑相P issue [#1107](https://github.com/xuri/excelize/issues/1107)
* 支持O定屑~分析表蟊丫帧敢嚎s形式@示」或「以大V形式@示」, 相P issue [#1029](https://github.com/xuri/excelize/issues/1029)
* 列/诘代器支持@取前列/谛蛱和列/诳, 相P issue [#1054](https://github.com/xuri/excelize/issues/1054)
* 使用 time.Time 型e颠M行存Ω褓x值r，支持r^位置, 相P issue [#1069](https://github.com/xuri/excelize/issues/1069)
* 新增С 7 e`信息，以便_l者可根不同的e`型eM行袢∠理

### 兼容性提升

* 提升c炔в `r="0"` 傩怨ぷ鞅淼募嫒菪
* 保留 XML 控制字符
* 提升邮皆O定c Apple Numbers 表格用程式的兼容性, 相P issue [#1059](https://github.com/xuri/excelize/issues/1059)
* 眉_字符迪拗萍嫒荻辔辉M字符, 相P issue [#1061](https://github.com/xuri/excelize/issues/1061)
* O定存Ωr⒈Ａ羲平制表符, 相P issue [#1108](https://github.com/xuri/excelize/issues/1108)

### }修

* 修筒糠智r下h除Y料C失〉}, 解Q issue [#979](https://github.com/xuri/excelize/issues/979)
* 修筒糠智r下O定Y料C下拉列表失〉}, 解Q issue [#986](https://github.com/xuri/excelize/issues/986)
* 修凸式算引擎 `LOOKUP` 函挡糠智r下算Y果e`的}, 解Q issue [#994](https://github.com/xuri/excelize/issues/994)
* 修凸式算引擎 `LOOKUP` H支持完全匹配的}, 解Q issue [#997](https://github.com/xuri/excelize/issues/997)
* 修凸式算引擎百分比算e`的}, 解Q issue [#993](https://github.com/xuri/excelize/issues/993)
* 修吞囟ㄇr下存Ω褡x取常е碌 panic
* 修驮O定「後 N 」l件格式失〉}
* 修筒糠智r下rg解析e`的}, 解Q issue [#1026](https://github.com/xuri/excelize/issues/1026) 和 [#1030](https://github.com/xuri/excelize/issues/1030)
* 修涂W捣底指袷降拇Ω裰到馕霎常的}，解Q issue [#1027](https://github.com/xuri/excelize/issues/1027)
* 修筒糠智r下浮c型Y料x取常的}，解Q issue [#1031](https://github.com/xuri/excelize/issues/1031)
* 修筒糠智r下h除工作表失〉}
* 修冉rg底指袷浇馕霎常}，解Q issue [#1060](https://github.com/xuri/excelize/issues/1060)
* 修筒糠智r下新建邮r返回邮 ID 常的}
* 修筒糠智r下h除行列後合愦Ω^域常的}

### 性能化

* 合愦Ω裥阅艽蠓提升，耗r降低 90%
* 提高流式x取性能，炔 XML ^大r，⒐蚕碜址串表解嚎s到系yRr文件，却媸褂昧p少s 60%, 相P issue [#1096](https://github.com/xuri/excelize/issues/1096)
* 化x取工作表列表性能
* 化O定列邮酱Γs小生成的n案we，解Q issue [#1057](https://github.com/xuri/excelize/issues/1057)

### 其他

* Go Modules 依模K更新
* 卧yc文n更新
* 包含w中文、英Z、法Z、俄Z、日Z、nZ、阿拉伯Z、德Z和西班牙Z的[多Z言文nW站](https://xuri.me/excelize)更新

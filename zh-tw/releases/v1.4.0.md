# Excelize v1.4.0

* 釋出日期: 2018年8月14日
* GitHub Release: [https://github.com/xuri/excelize/releases/tag/v1.4.0](https://github.com/xuri/excelize/releases/tag/v1.4.0)

## Release Notes

此版本中最顯著的變化包括：

### API 更改

* 下列函數增加了錯誤返回值: `AddChart()`、`AddComment()`、`AddPicture()`、`AddShape()`、`AddTable()` 和 `SetConditionalFormat()`

### 新增功能

* 新增函數 [`GetComments()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#File.GetComments) 支持獲取指定工作表中全部註解內容的哈希表
* 新增函數 [`RGBToHSL()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#RGBToHSL) 和 [`HSLToRGB()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#HSLToRGB) 支持 RGBA 和 HSL 之間的色值轉換
* 新增函數 [`NewDataValidation()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#NewDataValidation) 與系列函數 [`DataValidation.SetDropList()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#DataValidation.SetDropList)、[`DataValidation.SetError()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#DataValidation.SetError)、[`DataValidation.SetInput()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#DataValidation.SetInput)、[`DataValidation.SetRange()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#DataValidation.SetRange)、[`DataValidation.SetSqref()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#DataValidation.SetSqref) 和 [`DataValidation.SetSqrefDropList()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#DataValidation.SetSqrefDropList) 支持設定資料驗證
* 新增函數 [`AddPictureFromBytes()`](https://pkg.go.dev/github.com/360EntSecGroup-Skylar/excelize@v1.4.0#File.AddPictureFromBytes) 支持從位元組數組添加圖片到工作表，相關 issue [#259](https://github.com/xuri/excelize/issues/259)
* 函數 `GetCellFormula()` 現已支持獲取儲存格共享公式，相關 issue [#227](https://github.com/xuri/excelize/issues/227)
* 新增日期解析擴展支持
* 雙色標記與三色標記的條件式格式支持設定最小值、中間值和最大值

### 問題修復

* 更新默認插入註解樣式，修復插入多個註解時註解框位置堆疊的問題
* 修復部分情況下通過 `NewSheet()` 創建工作表導致的問題，相關 issue [#249](https://github.com/xuri/excelize/issues/249)

### 性能優化

* 讀寫速度提升 20%，設定儲存格內存使用減少 14%。更多性能資料請參考 [Performance Figures](github.com/xuri/excelize/wiki#performance-figures)
* 使用第三方依賴包 [github.com/mohae/deepcopy](github.com/mohae/deepcopy) 進行工作表深度拷貝代替基於 [encoding/gob](https://blog.golang.org/gobs-of-data) 序列化和反序列化實現的內部 `deepcopy`
